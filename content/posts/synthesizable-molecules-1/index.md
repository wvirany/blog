---
title: "Generating Synthesizable Molecules (1/2)"  
date: ""  
summary: "Part 1: Projecting Molecules into Synthesizable Chemical Spaces"  
description: ""  
draft: true  
toc: false  
readTime: true  
autonumber: false  
math: true  
tags: []
showTags: false  
hideBackToTop: false
---

A significant challenge in the use of generative modeling for molecular design is the problem of synthesizability. That is, a fancy deep learning model might make a molecule that checks all of our boxes in terms of desirable properties, but can it actually be synthesized in a lab? If the answer is no, then that *in silico* molecule is not very useful.

There are many attempts to overcome this problem, but one elegant approach is the work of [Luo et al. [2024]](https://arxiv.org/pdf/2406.04628), in which they "project" molecules into synthesizable chemical space.

I've reimplemented this paper with some minor simplifications to demonstrate stuff...

### Prelims

Here are a few packages we'll use:

```python
import torch
import torch.nn as nn

from rdkit import Chem
from rdkit.Chem import AllChem, rdChemReactions

from typing import List, Dict, Union
```



### Defining Chemical Space

We can define a chemical space $\mathcal{C}$ as a set of molecules generated by a set of building block molecules, denoted

$$
\mathcal{B} = \{B_1, B_2, \dots, B_N\},
$$

and a set of reaction rules, denoted

$$
\mathcal{R} = \{R_1, R_2, \dots, R_M\}.
$$

A reaction rule is a function which maps a set of reactions to a set of reaction products. This can be formalized as

$$
\begin{align*}
R: \mathcal{X_1} \times \mathcal{X_2} &\to \mathcal{C}, \quad \text{or} \\\\
(X_1, X_2) &\mapsto Y.
\end{align*}
$$

Here, $\mathcal{X_1}$ and $\mathcal{X_2}$ are sets of molecules to which reaction $R$ can be applied, and $Y$ is the main reaction product. $\mathcal{C}$ is then constructed by applying the reactions iteratively to every possible combination of molecules. For the sake of clarity, we assume the reaction only has one main product, although this is not always the case. However, the implementation which follows supports both cases.

Let's implement this. We start by defining `Molecule` and `Reaction` classes:

```python
class Molecule:

    def __init__(self, smiles: str):
        self.smiles = smiles
        self._rdmol = Chem.MolFromSmiles(smiles)
    
    @property
    def rdmol(self):
        return self._rdmol
```


### Postfix Notation of Synthesis

In this work, the authors formalize the synthetic process as a sequence of function calls, organized in a stack. 





### References and Further Reading

1. Shitong Luo, Wenhao Gao, Zuofan Wu, Jian Peng, Connor W. Coley, and Jianzhu Ma. Projecting molecules into
synthesizable chemical spaces. In Forty-first International Conference on Machine Learning, 2024.